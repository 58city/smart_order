(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03ec2a09"],{"13b6":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"widget"}},[n("div",{staticClass:"widget-header"},[t.tab?t._e():n("h2",[t._t("title")],2),t.tab?n("ul",{staticClass:"widget-tabs"},t._l(t.tabTitles,(function(e,a){return n("li",{key:a,class:{active:a==t.currentTabIndex},on:{click:function(e){return t.toggleTab(a)}}},[t._v(" "+t._s(e)+" ")])})),0):t._e(),t.search?n("div",{staticClass:"widget-search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchContent,expression:"searchContent"}],attrs:{type:"text",placeholder:"请输入搜索内容"},domProps:{value:t.searchContent},on:{input:function(e){e.target.composing||(t.searchContent=e.target.value)}}}),n("span",{on:{click:t.searchSubmit}},[n("i",{staticClass:"fa fa-search"})])]):t._e(),n("div",{staticClass:"widget-ctrls"},[t._t("button")],2)]),n("div",{staticClass:"widget-body"},[t._t("body")],2),t.footer?n("div",{staticClass:"widget-footer"}):t._e()])},i=[],r={name:"Panel",data:function(){return{searchContent:"",currentTabIndex:0}},props:{tab:{type:Boolean,default:!1},tabTitles:{type:Array,default:function(){return[]}},search:{type:Boolean,default:!1},footer:{type:Boolean,default:!1}},methods:{toggleTab:function(t){this.currentTabIndex=t,this.$emit("tabClicked",this.currentTabIndex)},searchSubmit:function(){this.$emit("searchClicked",this.searchContent)}}},o=r,s=(n("302b"),n("2877")),c=Object(s["a"])(o,a,i,!1,null,"7b3f540d",null);e["a"]=c.exports},"27c3":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return s}));var a=n("314e");function i(t){return Object(a["a"])({url:"/api/account/sign-in",method:"put",data:t})}function r(){return Object(a["a"])({url:"/api/account/sign-out",method:"put"})}function o(){return Object(a["a"])({url:"/api/account",method:"get"})}function s(t){return Object(a["a"])({url:"/api/account",method:"put",data:t})}},"302b":function(t,e,n){"use strict";var a=n("59f6"),i=n.n(a);i.a},"3ceb":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n("314e");function i(t){var e={};return t.email&&(e.email=t.email),t.nickname&&(e.nickname=t.nickname),Object(a["a"])({url:"api/users",method:"get",params:e})}},"498a":function(t,e,n){"use strict";var a=n("23e7"),i=n("58a8").trim,r=n("e070");a({target:"String",proto:!0,forced:r("trim")},{trim:function(){return i(this)}})},"4b6c":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"my-account"}},[n("input",{staticStyle:{position:"absolute",top:"-10000px"},attrs:{type:"text"}}),n("input",{staticStyle:{position:"absolute",top:"-10000px"},attrs:{type:"password"}}),n("panel",[n("span",{attrs:{slot:"title"},slot:"title"},[t._v("基本信息")]),n("button",{attrs:{slot:"button",disabled:t.disabled},on:{click:t.save},slot:"button"},[n("i",{staticClass:"fa fa-save"}),t._v("保存设置")]),n("el-form",{ref:"myInfoForm",attrs:{slot:"body",model:t.myInfo,rules:t.rules,"label-width":"100px","status-icon":""},slot:"body"},[n("el-form-item",{attrs:{label:"角色名称"}},[n("el-input",{attrs:{disabled:"",value:t.rolename}})],1),n("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[n("el-input",{model:{value:t.myInfo.email,callback:function(e){t.$set(t.myInfo,"email",e)},expression:"myInfo.email"}})],1),n("el-form-item",{attrs:{label:"管理员昵称",prop:"nickname"}},[n("el-input",{model:{value:t.myInfo.nickname,callback:function(e){t.$set(t.myInfo,"nickname",e)},expression:"myInfo.nickname"}})],1),n("el-form-item",{attrs:{label:"新密码",prop:"password"}},[n("el-input",{attrs:{type:"password"},model:{value:t.myInfo.password,callback:function(e){t.$set(t.myInfo,"password",e)},expression:"myInfo.password"}})],1),n("el-form-item",{attrs:{label:"确认密码",prop:"confirm"}},[n("el-input",{attrs:{type:"password"},model:{value:t.myInfo.confirm,callback:function(e){t.$set(t.myInfo,"confirm",e)},expression:"myInfo.confirm"}})],1)],1)],1)],1)},i=[],r=(n("498a"),n("13b6")),o=n("3ceb"),s=n("27c3"),c={name:"MyAccount",data:function(){var t=this;return{myInfo:{email:"",nickname:"",password:"",confirm:""},oldEmail:"",oldNickname:"",rules:{email:[{required:!0,message:"请输入电子邮箱",trigger:"change"},{pattern:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,message:"请填写正确的邮箱地址",trigger:"change"},{validator:function(e,n,a){if(n==t.oldEmail)return a();Object(o["a"])({email:n}).then((function(t){""==t.data?a():a(new Error("邮箱被占用！"))})).catch((function(e){t.$message.error(e.message)}))},trigger:"change"}],nickname:[{required:!0,message:"请输入用户昵称",trigger:"change"},{validator:function(e,n,a){if(n==t.oldNickname)return a();Object(o["a"])({nickname:n}).then((function(t){""==t.data?a():a(new Error("昵称被占用！"))})).catch((function(e){t.$message.error(e.message)}))},trigger:"change"}],password:[{min:6,message:"密码不得小于6位",trigger:"change"},{validator:function(e,n,a){return""!==t.myInfo.confirm&&t.$refs.myInfoForm.validateField("confirm"),a()},trigger:"change"}],confirm:[{validator:function(e,n,a){return n!==t.myInfo.password?a(new Error("两次输入密码不一致!")):a()},trigger:"change"}]},disabled:!1}},created:function(){this.get()},methods:{get:function(){this.myInfo.email=this.email,this.myInfo.nickname=this.nickname,this.oldEmail=this.email,this.oldNickname=this.nickname},save:function(){var t=this;this.$refs.myInfoForm.validate((function(e){if(t.disabled=!0,e){var n=Object.assign({},t.myInfo);delete n.confirm,0==n.password.trim().length&&delete n.password,Object(s["d"])(n).then((function(e){t.$message.success("账号修改成功"),t.oldEmail=n.email,t.oldNickname=n.nickname,t.$store.commit("setEmail",n.email),t.$store.commit("setNickname",n.nickname),setTimeout((function(){return t.disabled=!1}),1e3)})).catch((function(e){t.$message.error(e.message),setTimeout((function(){return t.disabled=!1}),1e3)}))}}))}},components:{Panel:r["a"]},computed:{email:function(){return this.$store.state.email},nickname:function(){return this.$store.state.nickname},rolename:function(){return this.$store.state.rolename}}},l=c,u=n("2877"),m=Object(u["a"])(l,a,i,!1,null,null,null);e["default"]=m.exports},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var a=n("1d80"),i=n("5899"),r="["+i+"]",o=RegExp("^"+r+r+"*"),s=RegExp(r+r+"*$"),c=function(t){return function(e){var n=String(a(e));return 1&t&&(n=n.replace(o,"")),2&t&&(n=n.replace(s,"")),n}};t.exports={start:c(1),end:c(2),trim:c(3)}},"59f6":function(t,e,n){},e070:function(t,e,n){var a=n("d039"),i=n("5899"),r="​᠎";t.exports=function(t){return a((function(){return!!i[t]()||r[t]()!=r||i[t].name!==t}))}}}]);
//# sourceMappingURL=chunk-03ec2a09.58ed7e83.js.map